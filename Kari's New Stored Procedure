use IMT543_Proj_03


SELECT * from tblCUSTOMER
--- created successfully
Create PROCEDURE jakrInsertCustomerPhone
@ACode  INT,
@PNumber INT,
@CFName varchar (20),
@CLName varchar (20)
AS
DECLARE @C_ID INT

SET @C_ID = (SELECT CustomerID FROM tblCUSTOMER WHERE CustomerFName = @CFName AND CustomerLName = @CLName)

BEGIN TRAN G1
INSERT INTO tblCUSTOMER_PHONE (AreaCode, PhoneNumber, CustomerID)
VALUES (@ACode, @PNumber, @C_ID)

COMMIT TRAN G1
GO

EXEC jakrInsertCustomerPhone
@ACode = 503,
@PNumber = 5032641141,
@CFName = 'Haile',
@CLName = 'Barajas'

EXEC jakrInsertCustomerPhone
@ACode = '458',
@PNumber = '4582006291',
@CFName = 'Cara',
@CLName = 'Priest'

-----DONE
CREATE PROCEDURE jakrInsertProduct
@UPrice NUMERIC (5,2), -- max (99999. 99)
@SKU Varchar (20),
@PName Varchar (20),
@PCategoryName Varchar (20)
AS
DECLARE @PC_ID INT

SET @PC_ID = (SELECT ProductCategoryID FROM tblPRODUCT_CATEGORY WHERE ProductCategoryName = @PCategoryName)

BEGIN TRAN G1
INSERT INTO tblPRODUCT (UnitPrice, SKU, ProductName, ProductCategoryID)
VALUES (@UPrice, @SKU, @PName, @PC_ID)

COMMIT TRAN G1
GO

EXEC jakrInsertProduct
@UPrice = 50.45,
@SKU = '84625694',
@PName = 'Print Faux Fur Coat',
@PCategoryName = 'Apparel'

EXEC jakrInsertProduct
@UPrice = 89.89,
@SKU = '84614874',
@PName = 'Acorn Sportswear',
@PCategoryName = 'Sportswear'


-- WILL WORK ON THIS LATER AS THIS HAS 2 FKS

CREATE PROCEDURE jakrInsertOrderProduct
@Quantity INT,
@UPrice Varchar (20),
@SKU Varchar (20),
@ODate DATE
AS 
DECLARE @P_ID INT, @O_ID INT


SET @P_ID = (SELECT ProductID FROM tblPRODUCT WHERE UnitPrice = @UPrice)

CREATE PROCEDURE jakrGetProductID
@UP Varchar (20),
@SKU Varchar (20),
@ProductID INT OUTPUT
AS
SET @ProductID = (SELECT ProductID
                FROM tblPRODUCT
                WHERE Unitprice = @UP
                AND SKU = @SKU) 


SET @O_ID = (SELECT OrderID FROM tblORDER WHERE OrderDate = @ODate)

CREATE PROCEDURE jakrGetOrderID
@OD Varchar (20),
@OrderID INT OUTPUT
AS
SET @OrderID = (SELECT OrderID FROM tblORDER WHERE OrderDate = @OD)


ALTER PROCEDURE jakrInsertOrderProduct
@Quantity INT (20),
@UPrice Varchar (20),
@SKU Varchar (20),
@ODate DATE
AS 
DECLARE @P_ID INT, @O_ID INT


EXEC jakrGetProductID
@UP = @UPrice,
@SKU = @SKU,
@@ProductID = P_ID OUTPUT

EXEC jakrGetOrderID
@OD = @ODate
@OrderID = O_ID OUTPUT

INSERT INTO tblORDER_PRODUCT(Unitprice, SKU, OrderDate, ProductID, OrderID)
VALUES (@Quantity, @P_ID,@, @O_ID)


EXEC jakrInsertOrderProduct
@UPrice = '50',
@SKU = '84625694',
@ODate = 
@Quantity = '15'

EXEC jakrInsertOrderProduct
@UPrice = '89',
@SKU = '84614874',
@ODate = 
@Quantity = '25'
